<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>CORS 跨域</title>
</head>
<body>
  
  <script>

    (function() {
      function makeRequest() {
        httpRequest = new XMLHttpRequest()

        if (!httpRequest) {
          alert('not assert') 
          return
        }

        httpRequest.onreadystatechange = makeHandle
        httpRequest.open('get', 'http://localhost:3001/removeCORS.js?id=1')
        // application/x-www-form-urlencoded、multipart/form-data、text/plain
        // 设置其它请求头会多发一次options请求
        httpRequest.setRequestHeader("Content-Type", 'application/json') 
        httpRequest.send()
      }

      function makeHandle() {
        if (httpRequest.readyState === XMLHttpRequest.DONE) {
          if (httpRequest.status === 200) {
            console.log(httpRequest.responseText)
          } else {
            console.log('error')
          }
        }
      }

      makeRequest()
    })()

    
  </script>
</body>
</html>